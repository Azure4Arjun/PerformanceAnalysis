<?xml version="1.0" encoding="utf-8"?>
<DataSchemaModel FileFormatVersion="1.2" SchemaVersion="2.9" DspName="Microsoft.Data.Tools.Schema.Sql.Sql130DatabaseSchemaProvider" CollationLcid="1033" CollationCaseSensitive="False" xmlns="http://schemas.microsoft.com/sqlserver/dac/Serialization/2012/02">
	<Header>
		<CustomData Category="AnsiNulls">
			<Metadata Name="AnsiNulls" Value="True" />
		</CustomData>
		<CustomData Category="QuotedIdentifier">
			<Metadata Name="QuotedIdentifier" Value="True" />
		</CustomData>
		<CustomData Category="CompatibilityMode">
			<Metadata Name="CompatibilityMode" Value="130" />
		</CustomData>
		<CustomData Category="Reference" Type="Assembly">
			<Metadata Name="LogicalName" Value="ServerAnalysisDW.dll" />
			<Metadata Name="FileName" Value="M:\LOVETHESQL\REPOSITORY\PERFORMANCEANALYSIS\SERVERANALYSISDW\OBJ\RELEASE\SERVERANALYSISDW.DLL" />
			<Metadata Name="AssemblyName" Value="ServerAnalysisDW" />
			<Metadata Name="PermissionSet" Value="SAFE" />
			<Metadata Name="Owner" Value="" />
			<Metadata Name="GenerateSqlClrDdl" Value="True" />
			<Metadata Name="IsVisible" Value="True" />
			<Metadata Name="IsModelAware" Value="True" />
			<Metadata Name="SkipCreationIfEmpty" Value="True" />
			<Metadata Name="AssemblySymbolsName" Value="M:\LoveTheSql\Repository\PerformanceAnalysis\ServerAnalysisDW\obj\Release\ServerAnalysisDW.pdb" />
		</CustomData>
		<CustomData Category="SqlCmdVariables" Type="SqlCmdVariable" />
	</Header>
	<Model>
		<Element Type="SqlDatabaseOptions">
			<Property Name="Collation" Value="SQL_Latin1_General_CP1_CI_AS" />
			<Property Name="IsAnsiNullDefaultOn" Value="True" />
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Property Name="IsAnsiWarningsOn" Value="True" />
			<Property Name="IsArithAbortOn" Value="True" />
			<Property Name="IsConcatNullYieldsNullOn" Value="True" />
			<Property Name="IsTornPageProtectionOn" Value="False" />
			<Property Name="IsFullTextEnabled" Value="True" />
			<Property Name="CompatibilityMode" Value="130" />
			<Property Name="PageVerifyMode" Value="3" />
			<Property Name="DefaultLanguage" Value="" />
			<Property Name="DefaultFullTextLanguage" Value="" />
			<Property Name="QueryStoreStaleQueryThreshold" Value="367" />
			<Relationship Name="DefaultFilegroup">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[PRIMARY]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlSchema" Name="[Analysis]">
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[AgentFailuresGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

	SELECT 
			ServerName, DateKey, TimeKey, Job_Name, Step_Name, Step_ID, Severity, Message
	FROM	[Analysis].[AgentJobFailures]
	WHERE	(ServerName = @ServerName OR @ServerName = '--- All ---')
		AND	(DateKey BETWEEN CONVERT(INT,CONVERT(VARCHAR(10), @DateStart,112)) AND CONVERT(INT,CONVERT(VARCHAR(10), @DateEnd,112)))
	GROUP BY ServerName, DateKey, TimeKey, Job_Name, Step_Name, Step_ID, Severity, Message
	ORDER BY ServerName, DateKey, TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;


END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Analysis].[AgentJobFailures]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[DateKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[TimeKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[Job_Name]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[Step_Name]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[Step_ID]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[Severity]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentJobFailures].[Message]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentFailuresGet].[@ServerName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentFailuresGet].[@DateStart]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[AgentFailuresGet].[@DateEnd]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[AgentFailuresGet].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[AgentFailuresGet].[@DateStart]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[AgentFailuresGet].[@DateEnd]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="127" />
				<Property Name="Length" Value="825" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David SPeight&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[AgentFailuresGet] &#xD;&#xA;@ServerName VARCHAR(50),&#xD;&#xA;@DateStart DATETIME,&#xD;&#xA;@DateEnd DATETIME&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[AgentJobFailures]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[IDAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[ServerName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[DateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[TimeKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[Job_Name]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[Step_Name]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="150" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[Step_ID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[Severity]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[AgentJobFailures].[Message]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="6" />
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[Alert_DiskSpace]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
       -- SET NOCOUNT ON added to prevent extra result sets from
       -- interfering with SELECT statements.
       SET NOCOUNT ON;
 
    DECLARE @tResults TABLE (ServerName VARCHAR(50), DriveName VARCHAR(5), Size INT, FreeSPace INT, PercentFree INT)
       INSERT INTO @tResults
              (      ServerName ,
                     DriveName ,
                     Size ,
                     FreeSPace ,
                     PercentFree)
       SELECT ServerName,
                     DriveName,
                     CONVERT(INT,Size),
                     CONVERT(INT,FreeSpace),
                     CONVERT(INT,PercentFree)
       FROM   [Analysis].[DiskUsage] (NOLOCK)
       WHERE  Perfdate > CONVERT(DATE,GETDATE())
              AND PercentFree < @Threshold;
 
 
       IF (SELECT COUNT(*) FROM @tResults) > 0
       BEGIN
 
              DECLARE @body varchar(max);
              DECLARE @Subject VARCHAR(50)=(@@SERVERNAME+' DISC ALERT ');
      
              -- Create HTML table output for email body.
              SET @body = cast( (
              SELECT td = tServerName + '</td><td>' + tDriveName+ '</td><td>' + tSize+ '</td><td>' + tFreeSPace+ '</td><td>' + tPercentFree
              FROM (
                           SELECT  tServerName = ServerName,
                                         tDriveName = DriveName,
                                         tSize = CONVERT(VARCHAR(12),Size)+' gb',
                                         tFreeSPace = CONVERT(VARCHAR(12),FreeSPace)+' gb',
                                         tPercentFree = CONVERT(VARCHAR(12),PercentFree)+'%'
                           FROM @tResults
                       ) as d
              for xml path( 'tr' ), type ) as varchar(max) )
      
              SET @body = '<table cellpadding="2" cellspacing="2" border="1">'
                             + '<tr><th>ServerName</th><th>DriveName</th><th>Size</th><th>Free Space</th><th>Percent Free</th></tr>'
                             + replace( replace( @body, '&lt;', '<' ), '&gt;', '>' )
                             + '</table>'
      
              -- SEND EMAIL
              EXEC msdb.dbo.sp_send_dbmail
                     @profile_name = 'LoveTheSql',
                     @recipients = 'Dave@LoveTheSql.com',
                     @body = @Body,
                     @subject = @Subject ,
                     @body_format = 'HTML'; 
 
       END;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[DriveName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[Size]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[FreeSPace]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[PercentFree]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[DriveName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[Size]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[FreeSpace]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[PercentFree]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@Threshold]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[DriveName]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[Size]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[FreeSPace]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Alert_DiskSpace].[@tResults].[PercentFree]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[Alert_DiskSpace].[@tResults]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[Alert_DiskSpace].[@tResults].[ServerName]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="50" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[Alert_DiskSpace].[@tResults].[DriveName]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="5" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[Alert_DiskSpace].[@tResults].[Size]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[Alert_DiskSpace].[@tResults].[FreeSPace]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[Alert_DiskSpace].[@tResults].[PercentFree]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[Alert_DiskSpace].[@Threshold]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[11]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="164" />
				<Property Name="Length" Value="2711" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:           David Speight&#xD;&#xA;-- Create date: 2017-01-11&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[Alert_DiskSpace]&#xD;&#xA;@Threshold INT = 11&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[BatchRequestsSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @StartDate DATETIME = DATEADD(MINUTE, 0-@MinutesBack, @EndDate);


	SELECT	LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4) AS [TimeKey], 
			CONVERT(INT,BatReqSec) [BatchRequestSec]
	FROM Analysis.InstanceStats
	WHERE	[ServerNm] = @ServerName
		AND PerfDate BETWEEN @StartDate AND @EndDate;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BatchRequestsSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BatchRequestsSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BatReqSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BatchRequestsSec].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BatchRequestsSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BatchRequestsSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BatchRequestsSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="808" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[BatchRequestsSec] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[BufferCacheHitRatio]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @StartDate DATETIME = DATEADD(MINUTE, 0-@MinutesBack, @EndDate);


	SELECT	LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4) AS [TimeKey], 
			CONVERT(INT,BufCchHit) [BufferCacheHitPercent]
	FROM Analysis.InstanceStats
	WHERE	[ServerNm] = @ServerName
		AND PerfDate BETWEEN @StartDate AND @EndDate;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BufferCacheHitRatio].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BufferCacheHitRatio].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BufCchHit]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BufferCacheHitRatio].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BufferCacheHitRatio].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BufferCacheHitRatio].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BufferCacheHitRatio].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="817" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[BufferCacheHitRatio] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[BufferCacheSize]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,KbMemoryUsedByBufferPool/1024) [MemoryUsedByBufferPoolMB] 
	FROM Analysis.InstanceMemory
	WHERE	[ServerName] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BufferCacheSize].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BufferCacheSize].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[BufferCacheSize].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[KbMemoryUsedByBufferPool]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BufferCacheSize].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BufferCacheSize].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[BufferCacheSize].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1431" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[BufferCacheSize] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[Compiles]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	
	
		SELECT  
			SUM(SQLCompSec)/COUNT(*) AS SQLcompSec, 
			SUM(BatReqSec)/COUNT(*) AS BatReqSec,
			SUM(SQLRcmpSec)/COUNT(*) AS SQLRcmpSec,
			CONVERT(INT,( (SUM(BatReqSec)/COUNT(*)) / (SUM(SQLCompSec)/COUNT(*)) )) AS CompileRatio,
			CONVERT(INT,((SUM(SQLRcmpSec)/COUNT(*))/(SUM(SQLCompSec)/COUNT(*)))*100) AS ReCompileRatio
		FROM [Analysis].[InstanceStats]
		WHERE ServerNm = @ServerName
			AND PerfDate BETWEEN DATEADD(MINUTE,(0-@MinutesBack),@EndDate) AND @EndDate;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Analysis].[Compiles].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[SQLCompSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BatReqSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[SQLRcmpSec]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Compiles].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Compiles].[@MinutesBack]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[Compiles].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[Compiles].[@EndDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[Compiles].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="129" />
				<Property Name="Length" Value="893" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David Speight&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[Compiles] &#xD;&#xA;@ServerName VARCHAR(50),&#xD;&#xA;@EndDate DATETIME,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[DatabaseUsage]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[DatabaseUsageID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[DatabaseUsageAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[PerfDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[ServerName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[DatabaseName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[Collation]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[CompatibilityLevel]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[AutoShrink]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[RecoveryModel]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[Size]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DatabaseUsage].[SpaceAvailable]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="7" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[Analysis].[DF_Server_IsActive]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[((1))]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[Analysis].[Server].[IsActive]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="8" />
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[DiskMemoryStats]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[DiskMonitorStatID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[DiskMonitorStatAlternateKey]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[ServerNm]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[DateKey]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[TimeKey]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[TransactionRateSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[MemoryPagingRateSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[LogFlushesSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[LogBytesFlushedSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[ProcedureCacheRatio]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskMemoryStats].[SignalWaitPercent]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="9" />
		</Element>
		<Element Type="SqlIndex" Name="[Analysis].[DiskMemoryStats].[IX_DiskMemoryStats_ServerNm]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DiskMonitorStatAlternateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[DiskMemSignalWaits]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			SignalWaitPercent
	FROM Analysis.DiskMemoryStats
	WHERE	[ServerNm] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemSignalWaits].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemSignalWaits].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TimeKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[SignalWaitPercent]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemSignalWaits].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[DiskMemSignalWaits].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[DiskMemSignalWaits].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[DiskMemSignalWaits].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1276" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[DiskMemSignalWaits] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[DiskUsage]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[DiskUsageID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[DiskUsageAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[PerfDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[ServerName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[VolumeName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[DriveName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="5" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[Size]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[FreeSpace]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[DiskUsage].[PercentFree]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="10" />
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[DiskUseGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

	SELECT @SearchDate = (CASE WHEN @SearchDate IS NULL THEN CONVERT(DATE, GETDATE()) ELSE @SearchDate END);

	SELECT 
		 [DriveName] 
					 --+ ' ' + [VolumeName] 
					 AS [DriveName]
		,[Size]
		,[FreeSpace]
	FROM [Analysis].[DiskUsage]
	WHERE [ServerName] = @Instance
	AND CONVERT(DATE, [PerfDate]) = @SearchDate
	ORDER BY DriveName ASC, PerfDate ASC;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Analysis].[DiskUseGet].[@SearchDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[DriveName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[Size]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[FreeSpace]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUseGet].[@Instance]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[PerfDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[DiskUseGet].[@Instance]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[@@ServerName]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[DiskUseGet].[@SearchDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="849" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[DiskUseGet] &#xD;&#xA;@Instance VARCHAR(30) = @@ServerName,&#xD;&#xA;@SearchDate DATE = NULL&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[InstanceMemory]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[MemoryID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[MemoryAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[MemoryDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[DateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[TimeKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[ServerName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryUsedByBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryNeededPerCurrentWorkload]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryDynamicUsedForConnections]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryDynamicUsedForLocks]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryDynamicUsedForCache]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryDynamicUsedForQueryOptimization]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryDynamicUsedForHashSortIndexOps]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[KbMemoryConsumedByCursors]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[8kbPagesInBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[8kbDataPagesInBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[8kbFreePagesInBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[8kbReservedPagesInBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[8kbStolenPagesInBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[8kbPlaCachePagesInBufferPool]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[PageLifeExpectancy]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[NumberRequestsSecWaitForFreePage]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[NumberPagesFlushedDiskSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[NumberBuffersWrittenSecByBufferMgrLazyWriter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[MemoryGrantsPending]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceMemory].[MemoryGrantsOutstanding]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="11" />
		</Element>
		<Element Type="SqlIndex" Name="[Analysis].[InstanceMemory].[IX_InstanceMemory_ServerName]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[InstanceMemory].[ServerName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[MemoryAlternateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[InstanceMemoryGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	 -- Get size of SQL Server Page in bytes 
	 DECLARE @pg_size INT, @Instancename varchar(50) 
	 SELECT @pg_size = low from master..spt_values where number = 1 and type = 'E' 
 
	 -- Extract perfmon counters to a temporary table 
	 IF OBJECT_ID('tempdb..#perfmon_counters') is not null DROP TABLE #perfmon_counters 
	 SELECT * INTO #perfmon_counters FROM sys.dm_os_performance_counters 

	  -- Get SQL Server instance name 
	SELECT @Instancename = LEFT([object_name], (CHARINDEX(':',[object_name]))) FROM #perfmon_counters WHERE counter_name = 'Buffer cache hit ratio' 
 
	INSERT INTO [Analysis].[InstanceMemory]
	SELECT
		GETDATE(),
		CONVERT(VARCHAR(10), GETDATE(),112) [DateKey],
		LEFT((REPLACE(CONVERT(VARCHAR(10), GETDATE(),108),':','')),3)+'000' [TimeKey],
		CONVERT(VARCHAR(30),@@SERVERNAME),
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Total Server Memory (KB)'),				--[KbMemoryUsedByBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Target Server Memory (KB)'),			--[KbMemoryNeededPerCurrentWorkload]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Connection Memory (KB)'),				--[KbMemoryDynamicUsedForConnections]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Lock Memory (KB)'),						--[KbMemoryDynamicUsedForLocks]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'SQL Cache Memory (KB)'),				--[KbMemoryDynamicUsedForCache]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Optimizer Memory (KB) '),				--[KbMemoryDynamicUsedForQueryOptimization]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Granted Workspace Memory (KB) '),		--[KbMemoryDynamicUsedForHashSortIndexOps]
		(SELECT cntr_value FROM #perfmon_counters WHERE counter_name = 'Cursor memory usage' and instance_name = '_Total'),				--[KbMemoryConsumedByCursors]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name= @Instancename+'Buffer Manager' and counter_name = 'Total pages'),	--[8kbPagesInBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Database pages'),--[8kbDataPagesInBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Free pages'),	--[8kbFreePagesInBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Reserved pages'),--[8kbReservedPagesInBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Stolen pages'),	--[8kbStolenPagesInBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name=@Instancename+'Plan Cache' and counter_name = 'Cache Pages' and instance_name = '_Total'),	--[8kbPlaCachePagesInBufferPool]
		(SELECT cntr_value FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Page life expectancy'), --[PageLifeExpectancy]    CASE WHEN (cntr_value > 300) THEN 'PLE is Healthy' ELSE 'PLE is not Healthy' END as 'PLE Status'
		(SELECT cntr_value as [Free list stalls/sec] FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Free list stalls/sec'),			--[NumberRequestsSecWaitForFreePage]
		(SELECT cntr_value as [Checkpoint pages/sec] FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Checkpoint pages/sec'),			--[NumberPagesFlushedDiskSec]
		(SELECT cntr_value as [Lazy writes/sec] FROM #perfmon_counters WHERE object_name=@Instancename+'Buffer Manager' and counter_name = 'Lazy writes/sec'),						--[NumberBuffersWrittenSecByBufferMgrLazyWriter]
		(SELECT cntr_value as [Memory Grants Pending] FROM #perfmon_counters WHERE object_name=@Instancename+'Memory Manager' and counter_name = 'Memory Grants Pending'),			--[MemoryGrantsPending] 
		(SELECT cntr_value as [Memory Grants Outstanding] FROM #perfmon_counters WHERE object_name=@Instancename+'Memory Manager' and counter_name = 'Memory Grants Outstanding')	--[MemoryGrantsOutstanding]

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[Analysis].[InstanceMemoryGet].[#perfmon_counters]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[InstanceMemoryGet].[#perfmon_counters]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[InstanceMemoryGet].[#perfmon_counters].[*]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="474" />
				<Property Name="Length" Value="4706" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;/* Author:&#x9; Script to report Memory usage details of a SQL Server instance &#xD;&#xA; Author: Sakthivel Chidambaram, Microsoft http://blogs.msdn.com/b/sqlsakthi &#xD;&#xA; &#xD;&#xA; Date: June 2012 &#xD;&#xA; Version: V2 &#xD;&#xA; &#xD;&#xA; V1: Initial Release &#xD;&#xA; V2: Added PLE, Memory grants pending, Checkpoint, Lazy write,Free list counters &#xD;&#xA; */&#xD;&#xA;&#xD;&#xA;-- Create date: &lt;Create Date,,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description,,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[InstanceMemoryGet]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[InstanceStats]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[InstanceID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[InstanceAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[ServerID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[ServerNm]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[InstanceNm]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[PerfDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[FwdRecSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[PgSpltSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[BufCchHit]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[PgLifeExp]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[LogGrwths]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[BlkProcs]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[BatReqSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[SQLCompSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[InstanceStats].[SQLRcmpSec]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="12" />
		</Element>
		<Element Type="SqlIndex" Name="[Analysis].[InstanceStats].[IX_InstanceStats_ServerNm]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[InstanceStats].[ServerNm]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[Analysis].[InstanceStats].[InstanceAlternateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[KPI_QueryElapsedTimeGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

	DECLARE @EndDate DATETIME = (getdate());
	SELECT @MinutesBack = (CASE WHEN @MinutesBack > 10 then @MinutesBack+10 else 0 end);
	SELECT @DatabaseName = (CASE WHEN LEFT(@DatabaseName,3) = '---' THEN NULL ELSE @DatabaseName END); -- Get stats for all databases
	SELECT @Goal = (@Goal/(@MinutesBack/10)); 
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	-- Get data and time from 10 minutes ago.
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));

	WITH cteDATA AS (
									SELECT ([DatabaseName] +'..' + [Object_Name]) AS [Object_Name],  
									RANK() OVER (PARTITION BY [Object_Name] ORDER BY DateKey, TimeKey) [Rank],
									DateKey, 
									TimeKey, 
									SUM(Total_Seconds) [Total_Seconds], 
									SUM(Execution_Count) [Execution_Count]
									FROM	ServerAnalysisDW.Analysis.QueryElapsedTime
									WHERE	[ServerName] = @ServerName
										AND	(@DatabaseName IS NULL OR [DatabaseName] = @DatabaseName)
										AND (DateKey BETWEEN @DateKeyPrevious AND @DateKey)
										AND (TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey)
									GROUP BY [DatabaseName], [Object_Name], DateKey, TimeKey
									),

		cteDATAadd AS (
									SELECT TOP 10000 [Object_Name], Rank, DateKey, TimeKey, Total_Seconds, Execution_Count
											, LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey) AS [Total_Seconds_Lag]
											, [Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))) AS [Total_Seconds_Diff]
											, LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey) AS [Execution_Count_Lag]
											, [Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))) AS [Total_Count]
											, ISNULL([Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))),0) / NULLIF([Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))),0) AS [Average_Seconds]
									FROM	cteDATA
									GROUP BY [Object_Name], [Rank], DateKey, TimeKey, Total_Seconds, Execution_Count
									ORDER BY 1,2,3
				)
		
		SELECT TOP ((@MinutesBack-10)/10)
				DateKey, 
				TimeKey, 
				CONVERT(INT,SUM(Total_Seconds_Diff)) TotalSeconds,
				(CASE	WHEN	(SUM(Total_Seconds_Diff)) > @GOAL+10 THEN -1
						WHEN	(SUM(Total_Seconds_Diff)) < @GOAL-10 THEN 1
						ELSE 0 END) AS KPIStatus
		FROM cteDATAadd
		WHERE [Rank] > 1 AND Total_Seconds_Diff > 0.01 AND Total_Count > 0
		GROUP BY DateKey,TimeKey
		ORDER BY DateKey DESC, 
				TimeKey DESC	
		
	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[KPI_QueryElapsedTimeGet].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[KPI_QueryElapsedTimeGet].[@DatabaseName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[KPI_QueryElapsedTimeGet].[@Goal]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[Analysis].[KPI_QueryElapsedTimeGet].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA].[Object_Name]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA].[Rank]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA].[DateKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA].[TimeKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA].[Total_Seconds]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATA].[Execution_Count]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Object_Name]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Rank]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[DateKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[TimeKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Seconds]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Execution_Count]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Seconds_Lag]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Seconds_Diff]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Analysis].[NegToZero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Execution_Count_Lag]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Count]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Analysis].[NegToZero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[KPI_QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Average_Seconds]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[KPI_QueryElapsedTimeGet].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[KPI_QueryElapsedTimeGet].[@DatabaseName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[KPI_QueryElapsedTimeGet].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[KPI_QueryElapsedTimeGet].[@Goal]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[600]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="3459" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[KPI_QueryElapsedTimeGet] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@DatabaseName NVARCHAR(50),&#xD;&#xA;@MinutesBack INT = 60,&#xD;&#xA;@Goal INT = 600&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[LogBytesFlushedSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,LogBytesFlushedSec) [LogBytesFlushedSec]
	FROM Analysis.DiskMemoryStats
	WHERE	[ServerNm] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[LogBytesFlushedSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[LogBytesFlushedSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[LogBytesFlushedSec].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[LogBytesFlushedSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[LogBytesFlushedSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[LogBytesFlushedSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[LogBytesFlushedSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="152" />
				<Property Name="Length" Value="1422" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[LogBytesFlushedSec]  &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[LogFlushesSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,LogFlushesSec) [LogFlushesSec]
	FROM Analysis.DiskMemoryStats
	WHERE	[ServerNm] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[LogFlushesSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[LogFlushesSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[LogFlushesSec].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[LogFlushesSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[LogFlushesSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[LogFlushesSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[LogFlushesSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1404" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[LogFlushesSec] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[MemoryPagingRateSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,MemoryPagingRateSec) [MemoryPagingRateSec]
	FROM Analysis.DiskMemoryStats
	WHERE	[ServerNm] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[MemoryPagingRateSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[MemoryPagingRateSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[MemoryPagingRateSec].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[MemoryPagingRateSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[MemoryPagingRateSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[MemoryPagingRateSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[MemoryPagingRateSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1422" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[MemoryPagingRateSec] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlScalarFunction" Name="[Analysis].[NegToZero]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[float]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero].[@inNumber]" />
				</Entry>
			</Relationship>
			<Relationship Name="FunctionBody">
				<Entry>
					<Element Type="SqlScriptFunctionImplementation">
						<Property Name="BodyScript">
							<Value><![CDATA[
BEGIN
	-- Declare the return variable here
	DECLARE @outNumber FLOAT 

	SELECT @outNumber = (CASE WHEN @inNumber < 0 THEN 0 ELSE @inNumber END);
	-- Return the result of the function
	RETURN @outNumber

END]]></Value>
						</Property>
						<Annotation Type="SysCommentsObjectAnnotation">
							<Property Name="CreateOffset" Value="198" />
							<Property Name="Length" Value="495" />
							<Property Name="StartLine" Value="1" />
							<Property Name="StartColumn" Value="1" />
							<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;&lt;Author,,Name&gt;&#xD;&#xA;-- Create date: &lt;Create Date, ,&gt;&#xD;&#xA;-- Description:&#x9;&lt;Description, ,&gt;&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE FUNCTION [Analysis].[NegToZero]&#xD;&#xA;(&#xD;&#xA;@inNumber FLOAT&#xD;&#xA;)&#xD;&#xA;RETURNS FLOAT &#xD;&#xA;AS" />
						</Annotation>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[NegToZero].[@inNumber]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Relationship Name="Type">
				<Entry>
					<Element Type="SqlTypeSpecifier">
						<Property Name="Precision" Value="53" />
						<Relationship Name="Type">
							<Entry>
								<References ExternalSource="BuiltIns" Name="[float]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[OsMemoryUtilization]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			(CASE	WHEN KbMemoryUsedByBufferPool > KbMemoryNeededPerCurrentWorkload THEN KbMemoryUsedByBufferPool/(@RAMmb*10.24)
					ELSE KbMemoryNeededPerCurrentWorkload/(@RAMmb*10.24) END) [OsMemoryUsed]
	FROM Analysis.InstanceMemory
	WHERE	[ServerName] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[OsMemoryUtilization].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[OsMemoryUtilization].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[OsMemoryUtilization].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[TimeKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[KbMemoryUsedByBufferPool]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[KbMemoryNeededPerCurrentWorkload]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[OsMemoryUtilization].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[OsMemoryUtilization].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[OsMemoryUtilization].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1565" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[OsMemoryUtilization]  &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[PageLifeExpectancy]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @StartDate DATETIME = DATEADD(MINUTE, 0-@MinutesBack, @EndDate);


	SELECT	LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4) AS [TimeKey], 
			PgLifeExp [PageLifeExpectancy]
	FROM Analysis.InstanceStats
	WHERE	[ServerNm] = @ServerName
		AND PerfDate BETWEEN @StartDate AND @EndDate;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PageLifeExpectancy].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PageLifeExpectancy].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PgLifeExp]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PageLifeExpectancy].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PageLifeExpectancy].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PageLifeExpectancy].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PageLifeExpectancy].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="805" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[PageLifeExpectancy] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[PageSplitsSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @StartDate DATETIME = DATEADD(MINUTE, 0-@MinutesBack, @EndDate);


	SELECT	LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4) AS [TimeKey], 
			CONVERT(INT,PgSpltSec) [PageSplitSec]
	FROM Analysis.InstanceStats
	WHERE	[ServerNm] = @ServerName
		AND PerfDate BETWEEN @StartDate AND @EndDate;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PageSplitsSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PageSplitsSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PgSpltSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PageSplitsSec].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PageSplitsSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PageSplitsSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PageSplitsSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="802" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[PageSplitsSec] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_AgentJobFailures]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[AgentJobFailures].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[AgentJobFailures]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="6" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_DatabaseUsage]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[DatabaseUsage].[DatabaseUsageID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[DatabaseUsage]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="7" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_DiskMemoryStats]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[DiskMemoryStats].[DiskMonitorStatID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="9" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_DiskUsage]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[DiskUsage].[DiskUsageID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[DiskUsage]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="10" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_InstanceMemory]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[InstanceMemory].[MemoryID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="11" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_InstanceStats]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[InstanceStats].[InstanceID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="12" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_QueryElapsedTime]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[QueryElapsedTime].[ID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="13" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_Server]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[Server].[ServerID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="14" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[Analysis].[PK_ServerStats]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[ServerStats].[ServerID]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[Analysis].[ServerStats]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="15" />
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[PlanCacheSize]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,(KbMemoryDynamicUsedForCache/1024)) [MemoryDynamicUsedForCacheMB] 
	FROM Analysis.InstanceMemory
	WHERE	[ServerName] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PlanCacheSize].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PlanCacheSize].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PlanCacheSize].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[KbMemoryDynamicUsedForCache]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PlanCacheSize].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PlanCacheSize].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PlanCacheSize].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1437" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[PlanCacheSize] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[PLE]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	
	SELECT	SUM(CONVERT(INT,((KbMemoryUsedByBufferPool/128)/4000)*300))/COUNT(*) AS SuggestedPLE
		, CONVERT(INT,SUM(PageLifeExpectancy)/COUNT(*)) AS PLE
		, CONVERT(INT,(SUM(PageLifeExpectancy) - SUM(CONVERT(INT,((KbMemoryUsedByBufferPool/128)/4000)*300)))/COUNT(*)) AS Diff
		, CONVERT(INT,(((SUM(PageLifeExpectancy) - SUM(CONVERT(INT,((KbMemoryUsedByBufferPool/128)/4000)*300)))/COUNT(*))  / (SUM(PageLifeExpectancy)/COUNT(*)))*100) AS Pcnt
	FROM Analysis.InstanceMemory
	WHERE ServerName = @ServerName
		AND DATEKEY=@DateKey	
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PLE].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PLE].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[KbMemoryUsedByBufferPool]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[PageLifeExpectancy]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[PLE].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[DateKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[TimeKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PLE].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PLE].[@EndDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[PLE].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="129" />
				<Property Name="Length" Value="1341" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David Speight&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[PLE] &#xD;&#xA;@ServerName VARCHAR(50),&#xD;&#xA;@EndDate DATETIME,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[ProcedureCacheRatio]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,ProcedureCacheRatio) [ProcedureCacheRatio]
	FROM Analysis.DiskMemoryStats
	WHERE	[ServerNm] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ProcedureCacheRatio].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ProcedureCacheRatio].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ProcedureCacheRatio].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ProcedureCacheRatio]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ProcedureCacheRatio].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ProcedureCacheRatio].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ProcedureCacheRatio].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1423" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[ProcedureCacheRatio]  &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[QueryElapsedTime]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[ID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[IDAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[ServerName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[DatabaseName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[DateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[TimeKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[Object_Name]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[Total_Seconds]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Precision" Value="53" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[float]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[Execution_Count]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[QueryElapsedTime].[Query]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="IsMax" Value="True" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="13" />
		</Element>
		<Element Type="SqlIndex" Name="[Analysis].[QueryElapsedTime].[IX_QueryElapsedTime_DateKey_TimeKey_Object_Name]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[QueryElapsedTime].[DateKey]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[QueryElapsedTime].[TimeKey]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[QueryElapsedTime].[Object_Name]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DatabaseName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[Execution_Count]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[Total_Seconds]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlIndex" Name="[Analysis].[QueryElapsedTime].[IX_QueryElapsedTime_ServerName]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[QueryElapsedTime].[ServerName]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[IDAlternateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryElapsedTimeClean]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

 DELETE 
 FROM [Analysis].[QueryElapsedTime]
 WHERE DateKey < CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MONTH,(0-@MonthsToKeep),GETDATE()),112)));

 DELETE
 FROM [Analysis].[DatabaseUsage]
 WHERE PerfDate < DATEADD(MONTH,(0-@MonthsToKeep),GETDATE());

 DELETE 
 FROM [Analysis].[DiskMemoryStats]
 WHERE DateKey < CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MONTH,(0-@MonthsToKeep),GETDATE()),112)));

 DELETE
 FROM [Analysis].[DiskUsage]
 WHERE PerfDate < DATEADD(MONTH,(0-@MonthsToKeep),GETDATE());

 DELETE 
 FROM [Analysis].[InstanceMemory]
 WHERE DateKey < CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MONTH,(0-@MonthsToKeep),GETDATE()),112)));

 DELETE
 FROM [Analysis].[InstanceStats]
 WHERE PerfDate < DATEADD(MONTH,(0-@MonthsToKeep),GETDATE());

 DELETE
 FROM [Analysis].[ServerStats]
 WHERE PerfDate < DATEADD(MONTH,(0-@MonthsToKeep),GETDATE());

 
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DateKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeClean].[@MonthsToKeep]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DatabaseUsage]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DatabaseUsage].[PerfDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskUsage].[PerfDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceMemory].[DateKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PerfDate]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeClean].[@MonthsToKeep]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[2]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1124" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryElapsedTimeClean]&#xD;&#xA;@MonthsToKeep INT = 2&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryElapsedTimeGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

		SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

	SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	SELECT @DatabaseName = (CASE WHEN LEFT(@DatabaseName,3) = '---' THEN NULL ELSE @DatabaseName END);

	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	-- Get data and time from 10 minutes ago.
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));


	WITH cteDATA AS (
									SELECT ([DatabaseName] +'..' + [Object_Name]) AS [Object_Name],  
									RANK() OVER (PARTITION BY [Object_Name] ORDER BY DateKey, TimeKey) [Rank],
									DateKey, 
									TimeKey, 
									SUM(Total_Seconds) [Total_Seconds], 
									SUM(Execution_Count) [Execution_Count]
									FROM	ServerAnalysisDW.Analysis.QueryElapsedTime
									WHERE	[ServerName] = @ServerName
										AND	(@DatabaseName IS NULL OR [DatabaseName] = @DatabaseName)
										AND (DateKey BETWEEN @DateKeyPrevious AND @DateKey)
										AND (TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey)
										AND ([Object_Name] <> 'QueryElapsedTimeRecord') -- Do not count this sproc
										--AND (([Object_Name] <> 'GetCaseActivities') OR ([Object_Name] = 'GetCaseActivities' AND Execution_Count > 2) ) -- Hack for 2015-01-21 where 2 plans were in cache
									GROUP BY [DatabaseName], [Object_Name], DateKey, TimeKey
									),

		cteDATAadd AS (
									SELECT TOP 10000 [Object_Name], Rank, DateKey, TimeKey, Total_Seconds, Execution_Count
											, LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey) AS [Total_Seconds_Lag]
											, [Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))) AS [Total_Seconds_Diff]
											, LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey) AS [Execution_Count_Lag]
											, [Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))) AS [Total_Count]
											, ISNULL([Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))),0) / NULLIF([Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey, TimeKey))),0) AS [Average_Seconds]
									FROM	cteDATA
									GROUP BY [Object_Name], [Rank], DateKey, TimeKey, Total_Seconds, Execution_Count
									ORDER BY 1,2,3
				)
		
		SELECT
				[Object_Name], DateKey, 
				(Case when CONVERT(INT,LEFT((TimeKey/100),2)) > 19 THEN '0' + LEFT((TimeKey/100),1)
							Else LEFT((TimeKey/100),2) END) 
							+':'+RIGHT((TimeKey/100),2) [TimeKey], 
				Total_Seconds_Diff, Total_Count,
				(Total_Seconds_Diff/Total_Count) [Average_Seconds]
		FROM cteDATAadd
		WHERE [Rank] > 1 AND Total_Seconds_Diff > 0.01 AND Total_Count > 0
		ORDER BY 1,2,3;
		
	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGet].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGet].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGet].[@DatabaseName]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGet].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA].[Object_Name]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA].[Rank]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA].[DateKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA].[TimeKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA].[Total_Seconds]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATA].[Execution_Count]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Object_Name]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Rank]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[DateKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[TimeKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Seconds]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Execution_Count]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Seconds_Lag]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Seconds_Diff]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Analysis].[NegToZero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Execution_Count_Lag]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Total_Count]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Analysis].[NegToZero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGet].[CTE1].[cteDATAadd].[Average_Seconds]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGet].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGet].[@DatabaseName]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGet].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGet].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="3601" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryElapsedTimeGet] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@DatabaseName NVARCHAR(50) = NULL,&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryElapsedTimeGetDaily]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

	SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	SELECT @DatabaseName = (CASE WHEN LEFT(@DatabaseName,3) = '---' THEN NULL ELSE @DatabaseName END);

	DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(DAY,(0-@DaysBack),@EndDate),112)));
	
	WITH cteDATA AS (
									SELECT ([DatabaseName] +'..' + [Object_Name]) AS [Object_Name],  
									RANK() OVER (PARTITION BY [Object_Name] ORDER BY DateKey) [Rank],
									DateKey, 
									SUM(Total_Seconds) [Total_Seconds], 
									SUM(Execution_Count) [Execution_Count]
									FROM	ServerAnalysisDW.Analysis.QueryElapsedTime
									WHERE	[ServerName] = @ServerName
										AND	(@DatabaseName IS NULL OR [DatabaseName] = @DatabaseName)
										AND (DateKey BETWEEN @DateKeyPrevious AND @DateKey)
										AND ([Object_Name] <> 'QueryElapsedTimeRecord') -- Do not count this sproc
									GROUP BY [DatabaseName], [Object_Name], DateKey
									),

		cteDATAadd AS (
									SELECT TOP 10000 [Object_Name], Rank, DateKey, Total_Seconds, Execution_Count
											, LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey) AS [Total_Seconds_Lag]
											, [Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey))) AS [Total_Seconds_Diff]
											, LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey) AS [Execution_Count_Lag]
											, [Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey))) AS [Total_Count]
											, ISNULL([Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], DateKey))),0) / NULLIF([Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], DateKey))),0) AS [Average_Seconds]
									FROM	cteDATA
									GROUP BY [Object_Name], [Rank], DateKey, Total_Seconds, Execution_Count
									ORDER BY 1,2,3
				)
	
		SELECT
				[Object_Name], DateKey, 
				CONVERT(INT,SUM(Total_Seconds_Diff)) AS TotalSeconds, SUM(Total_Count) AS TotalCount,
				(SUM(Total_Seconds_Diff)/SUM(Total_Count)) [Average_Seconds]
		FROM cteDATAadd
		WHERE Total_Count > 0 AND rank > 1
		GROUP BY [Object_Name], DateKey
		HAVING  CONVERT(INT,SUM(Total_Seconds_Diff)) > 0
		ORDER BY 1,2,3;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetDaily].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetDaily].[@DaysBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetDaily].[@DatabaseName]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetDaily].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATA]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATA].[Object_Name]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATA].[Rank]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATA].[DateKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATA].[Total_Seconds]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATA].[Execution_Count]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Object_Name]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Rank]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[DateKey]">
									<Relationship Name="ExpressionDependencies">
										<Entry />
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Total_Seconds]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Execution_Count]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Total_Seconds_Lag]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Total_Seconds_Diff]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Analysis].[NegToZero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Execution_Count_Lag]" />
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Total_Count]">
									<Relationship Name="ExpressionDependencies">
										<Entry>
											<References Name="[Analysis].[NegToZero]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlComputedColumn" Name="[Analysis].[QueryElapsedTimeGetDaily].[CTE1].[cteDATAadd].[Average_Seconds]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetDaily].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetDaily].[@DatabaseName]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetDaily].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetDaily].[@DaysBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[10]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="129" />
				<Property Name="Length" Value="2800" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="&#xD;&#xA;-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David Speight&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryElapsedTimeGetDaily] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@DatabaseName NVARCHAR(50) = NULL,&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@DaysBack INT = 10&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryElapsedTimeGetOld]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

		SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

	SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	SELECT @DatabaseName = (CASE WHEN LEFT(@DatabaseName,3) = '---' THEN NULL ELSE @DatabaseName END);

	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	-- Get data and time from 10 minutes ago.
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));

	SELECT	[Object_Name], 
			[Rank]-1 AS [Rank],
			DateKey, 
			CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey],
			SUM(ISNULL([Total_Seconds_Diff],0)) AS [Total_Seconds_Diff],
			SUM(ISNULL([Execution_Count_Diff],0)) AS [Total_Count],
			SUM(ISNULL([Total_Seconds_Diff],0)) / SUM(NULLIF([Execution_Count_Diff],0))
			--ISNULL([ElapsedTime],0) 
			AS [Average_Seconds]
	FROM (
	SELECT	([DatabaseName] +'..' + [Object_Name]) AS [Object_Name],  
	RANK() OVER (PARTITION BY [Object_Name], Query ORDER BY DateKey, TimeKey) [Rank],
	DateKey, TimeKey, Total_Seconds, Execution_Count, Query,
	LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], Query, DateKey, TimeKey) AS [Total_Seconds_Lag],	
	[Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], Query, DateKey, TimeKey))) AS [Total_Seconds_Diff],
	LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], Query, DateKey, TimeKey) AS [Execution_Count_Lag],
	[Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], Query, DateKey, TimeKey))) AS [Execution_Count_Diff],
	([Analysis].[NegToZero]((Total_Seconds - LAG(Total_Seconds,1,0) OVER (ORDER BY [Object_Name], Query, DateKey, TimeKey)))) / NULLIF(([Analysis].[NegToZero]((Execution_Count - LAG(Execution_Count,1,0) OVER (ORDER BY [Object_Name], Query, DateKey, TimeKey)))),0) AS [ElapsedTime]
	FROM	ServerAnalysisDW.Analysis.QueryElapsedTime
	WHERE	[ServerName] = @ServerName
		AND	(@DatabaseName IS NULL OR [DatabaseName] = @DatabaseName)
		AND (DateKey BETWEEN @DateKeyPrevious AND @DateKey)
		AND (TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey)
		AND ([Object_Name] <> 'QueryElapsedTimeRecord') -- Do not count this sproc

	) a
	WHERE (a.[Rank] > 1) AND (a.Total_Seconds_Diff > 0.0001) 
	GROUP BY [Object_Name], 
			[Rank]-1,
			DateKey,
			CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END))
	HAVING (SUM(ISNULL([Execution_Count_Diff],0)) > 100 OR SUM(ISNULL([Total_Seconds_Diff],0)) > 0.1) AND (SUM(ISNULL([Execution_Count_Diff],0)) > 0)
	ORDER BY [Object_Name], DateKey, TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetOld].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetOld].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetOld].[@DatabaseName]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Analysis].[QueryElapsedTimeGetOld].[@ServerName]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[NegToZero]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetOld].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetOld].[@DatabaseName]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetOld].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryElapsedTimeGetOld].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="3346" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryElapsedTimeGetOld] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@DatabaseName NVARCHAR(50) = NULL,&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryElapsedTimeRecord]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;
	SET DEADLOCK_PRIORITY LOW;
	SET XACT_ABORT ON;
	BEGIN TRANSACTION;
		INSERT INTO [ServerAnalysis].[Analysis].[QueryElapsedTime]
		([ServerName],[DatabaseName],[DateKey],[TimeKey],[Object_Name],[Total_Seconds],[Execution_Count],[Query])
		SELECT TOP 100
			@@SERVERNAME,
			DB_NAME(qt.dbid),
			CONVERT(VARCHAR(10), GETDATE(),112) [DateKey],
			LEFT((REPLACE(CONVERT(VARCHAR(10), GETDATE(),108),':','')),3)+'000' [TimeKey],
			o.name AS [object_name],
			qs.total_elapsed_time / 1000000.0 AS total_seconds,
			qs.execution_count,
			SUBSTRING (qt.text,qs.statement_start_offset/2, 
						(CASE	WHEN qs.statement_end_offset = -1 THEN LEN(CONVERT(NVARCHAR(MAX), qt.text)) * 2 
								ELSE qs.statement_end_offset END - qs.statement_start_offset)/2) AS individual_query
		FROM	sys.dm_exec_query_stats qs
				CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) as qt
				LEFT OUTER JOIN sys.objects o ON qt.objectid = o.object_id
		WHERE	qt.dbid = DB_ID()
			AND qs.last_execution_time > DATEADD(day, -1,GETDATE())
		ORDER BY (qs.total_elapsed_time / qs.execution_count / 1000000.0) DESC;
	COMMIT;
	SET TRAN ISOLATION LEVEL READ COMMITTED;
	RETURN 0;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[nvarchar]" />
				</Entry>
				<Entry />
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1455" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryElapsedTimeRecord]&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryObjectListGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;

    set transaction isolation level read uncommitted;

	declare @DateKeyStart int=CONVERT(VARCHAR(10), @DateStart,112);
	declare @DateKeyEnd int=CONVERT(VARCHAR(10), @DateEnd,112);

	select  DISTINCT [Object_Name]
	from [Analysis].[QueryElapsedTime]
	where	ServerName=@ServerName
		and	DatabaseName=@DatabaseName
		and Datekey between @DateKeyStart and  @DateKeyEnd
	order by [Object_Name]

	set transaction isolation level read committed;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryObjectListGet].[@DateStart]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryObjectListGet].[@DateEnd]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[Object_Name]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryObjectListGet].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DatabaseName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryObjectListGet].[@DatabaseName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryObjectListGet].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryObjectListGet].[@DatabaseName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryObjectListGet].[@DateStart]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryObjectListGet].[@DateEnd]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="224" />
				<Property Name="Length" Value="853" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David Speight&#xD;&#xA;-- Create date: August 15, 2016&#xD;&#xA;-- Description:&#x9;Pull performance stats on an individual object&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryObjectListGet] &#xD;&#xA;@ServerName varchar(50),&#xD;&#xA;@DatabaseName varchar(50),&#xD;&#xA;@DateStart date,&#xD;&#xA;@DateEnd date&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[QueryStatsGetOnObject]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;

    set transaction isolation level read uncommitted;

	declare @DateKeyStart int=CONVERT(VARCHAR(10), @DateStart,112);
	declare @DateKeyEnd int=CONVERT(VARCHAR(10), @DateEnd,112);

	select  qt.DateKey, CONVERT(DATE,CONVERT(varchar(8),qt.DateKey)) [StatDate],
			(Convert(varchar(50),qt.DateKey) + ' (' + Convert(varchar(50),SUM(qt.Execution_Count)) + ') ') [DateKeyText],
			SUM(qt.Execution_Count) [Executions], 			
			CONVERT(INT,(SUM(qt.Total_Seconds)/60)) [TotalWaitTime]
	from [Analysis].[QueryElapsedTime] qt
		INNER JOIN [Maintenance].[dbo].[DimDate] dt ON qt.Datekey = dt.Datekey
	where	qt.ServerName=@ServerName
		and	qt.DatabaseName=@DatabaseName
		and qt.[Object_Name]=@Object_Name
		and qt.Datekey between @DateKeyStart and  @DateKeyEnd
		and qt.Timekey between @HourStart and  @HourEnd
		and (@ExcludeWeekend=0 OR dt.IsWeekday=1)
	Group By qt.DateKey
	order by qt.Datekey;

	set transaction isolation level read committed;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@DateStart]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@DateEnd]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DateKey]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DateKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[Execution_Count]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[Total_Seconds]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[DatabaseName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@DatabaseName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[Object_Name]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@Object_Name]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryElapsedTime].[TimeKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@HourStart]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@HourEnd]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[QueryStatsGetOnObject].[@ExcludeWeekend]" />
				</Entry>
				<Entry />
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@DatabaseName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@Object_Name]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@DateStart]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@DateEnd]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@HourStart]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[90000]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@HourEnd]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[170000]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[QueryStatsGetOnObject].[@ExcludeWeekend]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[1]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="224" />
				<Property Name="Length" Value="1461" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David Speight&#xD;&#xA;-- Create date: August 15, 2016&#xD;&#xA;-- Description:&#x9;Pull performance stats on an individual object&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[QueryStatsGetOnObject] &#xD;&#xA;@ServerName varchar(50),&#xD;&#xA;@DatabaseName varchar(50),&#xD;&#xA; @Object_Name varchar(50),&#xD;&#xA;@DateStart date,&#xD;&#xA;@DateEnd date,&#xD;&#xA;@HourStart int=90000,&#xD;&#xA;@HourEnd int = 170000,&#xD;&#xA;@ExcludeWeekend int =1&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[selComparativeAnalysisReport]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON

DECLARE @Sep INT, @BoxNm VARCHAR(50), @InstNm VARCHAR(50)

SELECT @Sep = CHARINDEX('\', @InstanceName)

IF @Sep > 0
  BEGIN
  SELECT @BoxNm = SUBSTRING(@InstanceName, 1, @Sep - 1), @InstNm = SUBSTRING(@InstanceName, @Sep + 1, (LEN(@InstanceName) - @Sep))
  END
ELSE
  BEGIN
  SELECT @BoxNm = @InstanceName, @InstNm = 'MSSQLSERVER'
  END

SELECT CONVERT(char(10), s.[PerfDate], 101) as PerfDate
      ,CONVERT(char(8), s.[PerfDate], 108) as PerfTime
      ,s.[PctProc]
      ,i.[BatReqSec]
      ,i.[BufCchHit]
      ,i.[PgLifeExp]
FROM [Analysis].[ServerStats] s
INNER JOIN [Analysis].[InstanceStats] i
ON s.[ServerAlternateKey] = i.[InstanceAlternateKey]
WHERE s.ServerNm = @BoxNm
AND i.ServerNm = @BoxNm
AND i.InstanceNm = @InstNm
AND s.[PerfDate] > DATEADD(dd, -35, GETDATE())
ORDER BY CONVERT(Date,s.[PerfDate]) DESC, PerfTime ASC]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[selComparativeAnalysisReport].[@InstanceName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[ServerAlternateKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[InstanceAlternateKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[char]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[char]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PctProc]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BatReqSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BufCchHit]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PgLifeExp]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[InstanceNm]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[selComparativeAnalysisReport].[@InstanceName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1120" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[selComparativeAnalysisReport] (@InstanceName varchar(50))&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[selPerformanceAnalysisReport]">
			<Property Name="BodyScript">
				<Value><![CDATA[
SET NOCOUNT ON

DECLARE @Sep INT, @BoxNm VARCHAR(50), @InstNm VARCHAR(50)

SELECT @Sep = CHARINDEX('\', @InstanceName)

IF @Sep > 0
  BEGIN
  SELECT @BoxNm = SUBSTRING(@InstanceName, 1, @Sep - 1), @InstNm = SUBSTRING(@InstanceName, @Sep + 1, (LEN(@InstanceName) - @Sep))
  END
ELSE
  BEGIN
  SELECT @BoxNm = @InstanceName, @InstNm = 'MSSQLSERVER'
  END

SELECT CONVERT(char(8), s.[PerfDate], 108) as PerfTime
      ,s.[ServerNm]
      ,i.[InstanceNm]
      ,s.[PctProc]
      ,s.[Memory]
      ,s.[PgFilUse]
      ,s.[DskSecRd]
      ,s.[DskSecWrt]
      ,s.[ProcQueLn]
      ,i.[FwdRecSec]
      ,i.[PgSpltSec]
      ,i.[BufCchHit]
      ,i.[PgLifeExp]
      ,i.[LogGrwths]
      ,i.[BlkProcs]
      ,i.[BatReqSec]
      ,i.[SQLCompSec]
      ,i.[SQLRcmpSec]
FROM [Analysis].[ServerStats] s
INNER JOIN [Analysis].[InstanceStats] i
ON s.[ServerAlternateKey] = i.[InstanceAlternateKey]
WHERE s.ServerNm = @BoxNm
AND i.ServerNm = @BoxNm
AND i.InstanceNm = @InstNm
AND s.[PerfDate] BETWEEN @PerfDate AND DATEADD(DAY,1,@PerfDate)


select TOP 60 CONVERT(Date,[PerfDate]) as PerfDate
FROM [Analysis].[ServerStats]
GROUP BY CONVERT(Date,[PerfDate])
ORDER BY PerfDate DESC]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[selPerformanceAnalysisReport].[@InstanceName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[ServerAlternateKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[InstanceAlternateKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[char]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[InstanceNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PctProc]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[Memory]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PgFilUse]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[DskSecRd]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[DskSecWrt]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[ProcQueLn]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[FwdRecSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PgSpltSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BufCchHit]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PgLifeExp]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[LogGrwths]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BlkProcs]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[BatReqSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[SQLCompSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[SQLRcmpSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[selPerformanceAnalysisReport].[@PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[date]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[selPerformanceAnalysisReport].[@InstanceName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[selPerformanceAnalysisReport].[@PerfDate]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1472" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[selPerformanceAnalysisReport] (@InstanceName varchar(50), @PerfDate DATETIME)&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[Server]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[Server].[ServerID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[Server].[ServerNm]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[Server].[IsActive]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="8" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[Server].[connString]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1500" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varbinary]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[Server].[RAMmb]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="14" />
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[ServerListGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;
	OPEN SYMMETRIC KEY [key_Analysis] DECRYPTION BY CERTIFICATE cert_keyAnalysis;

		SELECT	ServerNm,
				(CASE	WHEN @Version = '2012' THEN REPLACE(CONVERT(VARCHAR(150), DECRYPTBYKEY(connString)),'SQLNCLI10.1','SQLNCLI11.1')
				
						ELSE CONVERT(VARCHAR(150), DECRYPTBYKEY(connString)) END) AS connString
		FROM [Analysis].[Server] 
		WHERE isActive=1;

	CLOSE SYMMETRIC KEY [key_Analysis];
	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[key_Analysis]" />
				</Entry>
				<Entry>
					<References Name="[cert_keyAnalysis]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[ServerListGet].[@Version]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[connString]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[IsActive]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ServerListGet].[@Version]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[null]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="850" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[ServerListGet]&#xD;&#xA;@Version VARCHAR(50) = null&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlTable" Name="[Analysis].[ServerStats]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[ServerID]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[ServerAlternateKey]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[ServerNm]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="30" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[PerfDate]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[PctProc]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[Memory]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[PgFilUse]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[DskSecRd]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[DskSecWrt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Scale" Value="4" />
									<Property Name="Precision" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[decimal]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[Analysis].[ServerStats].[ProcQueLn]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="15" />
		</Element>
		<Element Type="SqlIndex" Name="[Analysis].[ServerStats].[IX_ServerStats_ServerNm]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[Analysis].[ServerStats].[ServerNm]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="IncludedColumns">
				<Entry>
					<References Name="[Analysis].[ServerStats].[ServerAlternateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="IndexedObject">
				<Entry>
					<References Name="[Analysis].[ServerStats]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[ServerStatsProcPercent]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

	SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);

	SELECT	CONVERT(INT,CONVERT(VARCHAR(10), PerfDate, 112)) [PerfCalendar],
			CONVERT(INT,LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4)) [PerfClock],
			[PctProc]
	FROM [ServerAnalysisDW].[Analysis].[ServerStats]
	WHERE PerfDate BETWEEN DATEADD(minute, 0-@MinutesBack, @EndDate) AND @EndDate
	AND ServerNm = @ServerName;

	SET TRANSACTION ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Analysis].[ServerStatsProcPercent].[@EndDate]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Analysis].[ServerStatsProcPercent].[@MinutesBack]" />
				</Entry>
				<Entry />
				<Entry>
					<References Name="[Analysis].[ServerStatsProcPercent].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ServerStatsProcPercent].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ServerStatsProcPercent].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[ServerStatsProcPercent].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="116" />
				<Property Name="Length" Value="816" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;DS&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[ServerStatsProcPercent] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[SqlCompilationsSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @StartDate DATETIME = DATEADD(MINUTE, 0-@MinutesBack, @EndDate);


	SELECT	LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4) AS [TimeKey], 
			CONVERT(INT,SQLCompSec) [SQLCompSec]
	FROM Analysis.InstanceStats
	WHERE	[ServerNm] = @ServerName
		AND PerfDate BETWEEN @StartDate AND @EndDate;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[SqlCompilationsSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[SqlCompilationsSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[SQLCompSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[SqlCompilationsSec].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[SqlCompilationsSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[SqlCompilationsSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[SqlCompilationsSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="805" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[SqlCompilationsSec]&#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[SqlReCompilationsSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN
	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @StartDate DATETIME = DATEADD(MINUTE, 0-@MinutesBack, @EndDate);


	SELECT	LEFT(REPLACE(CONVERT(VARCHAR(10), PerfDate, 108),':',''),4) AS [TimeKey], 
			CONVERT(INT,SQLRcmpSec) [SQLRCompSec]
	FROM Analysis.InstanceStats
	WHERE	[ServerNm] = @ServerName
		AND PerfDate BETWEEN @StartDate AND @EndDate;

	SET TRAN ISOLATION LEVEL READ COMMITTED;
END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[datetime]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[SqlReCompilationsSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[SqlReCompilationsSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[PerfDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[SQLRcmpSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[InstanceStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[SqlReCompilationsSec].[@ServerName]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[SqlReCompilationsSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[SqlReCompilationsSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[SqlReCompilationsSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="809" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[SqlReCompilationsSec] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[TimeListGet]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;

    declare @timeTable TABLE (TimeKey int, TimeHour int, TimeText varchar(12))
	insert into @timeTable (TimeKey,TimeHour,TimeText)
	values	(0,0,'12:00 AM'),
			(10000,1,'1:00 AM'),
			(20000,2,'2:00 AM'),
			(30000,3,'3:00 AM'),
			(40000,4,'4:00 AM'),
			(50000,5,'5:00 AM'),
			(60000,6,'6:00 AM'),
			(70000,7,'7:00 AM'),
			(80000,8,'8:00 AM'),
			(90000,9,'9:00 AM'),
			(100000,10,'10:00 AM'),
			(110000,11,'11:00 AM'),
			(120000,12,'12:00 PM'),
			(130000,13,'1:00 PM'),
			(140000,14,'2:00 PM'),
			(150000,15,'3:00 PM'),
			(160000,16,'4:00 PM'),
			(170000,17,'5:00 PM'),
			(180000,18,'6:00 PM'),
			(190000,19,'7:00 PM'),
			(200000,20,'8:00 PM'),
			(210000,21,'9:00 PM'),
			(220000,22,'10:00 PM'),
			(230000,23,'11:00 PM'),
			(235959,23,'11:59 PM');

	select TimeKey,TimeHour,TimeText
	from @timeTable
	order by TimeKey;


END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References Name="[Analysis].[TimeListGet].[@timeTable].[TimeKey]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[TimeListGet].[@timeTable].[TimeHour]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[TimeListGet].[@timeTable].[TimeText]" />
				</Entry>
			</Relationship>
			<Relationship Name="DynamicObjects">
				<Entry>
					<Element Type="SqlDynamicColumnSource" Name="[Analysis].[TimeListGet].[@timeTable]">
						<Relationship Name="Columns">
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[TimeListGet].[@timeTable].[TimeKey]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[TimeListGet].[@timeTable].[TimeHour]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[int]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
							<Entry>
								<Element Type="SqlSimpleColumn" Name="[Analysis].[TimeListGet].[@timeTable].[TimeText]">
									<Relationship Name="TypeSpecifier">
										<Entry>
											<Element Type="SqlTypeSpecifier">
												<Property Name="Length" Value="12" />
												<Relationship Name="Type">
													<Entry>
														<References ExternalSource="BuiltIns" Name="[varchar]" />
													</Entry>
												</Relationship>
											</Element>
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="224" />
				<Property Name="Length" Value="1179" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Author:&#x9;&#x9;David Speight&#xD;&#xA;-- Create date: August 15, 2016&#xD;&#xA;-- Description:&#x9;Pull performance stats on an individual object&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[TimeListGet] &#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlProcedure" Name="[Analysis].[TransactionRateSec]">
			<Property Name="BodyScript">
				<Value><![CDATA[
BEGIN

	SET NOCOUNT ON;
	SET TRAN ISOLATION LEVEL READ UNCOMMITTED;

    SELECT @EndDate = (CASE WHEN @EndDate IS NULL THEN (GETDATE()) ELSE @EndDate END);
	DECLARE @TimeKey INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), @EndDate,108),':','')),3)+'000'));
    DECLARE @DateKey INT = CONVERT(INT,(CONVERT(VARCHAR(10), @EndDate,112)));
	DECLARE @TimeKeyPrevious INT = CONVERT(INT,(SELECT LEFT((REPLACE(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),108),':','')),3)+'000'));
	DECLARE @DateKeyPrevious INT = CONVERT(INT,(CONVERT(VARCHAR(10), DATEADD(MINUTE,(0-@MinutesBack),@EndDate),112)));
	DECLARE @RAMmb INT = ISNULL((SELECT ISNULL(RAMmb,1) FROM Analysis.Server WHERE ServerNm = @ServerName),1);

	SELECT	CONVERT(INT,(CASE	WHEN LEN(TimeKey) = 6 THEN LEFT(TimeKey,4)
					ELSE LEFT(TimeKey,3) END)) AS [TimeKey], 
			CONVERT(INT,TransactionRateSec) [TransactionRateSec]
	FROM Analysis.DiskMemoryStats
	WHERE	[ServerNm] = @ServerName
		AND DateKey BETWEEN @DateKeyPrevious AND @DateKey
		AND TimeKey BETWEEN @TimeKeyPrevious AND @TimeKey;

	SET TRAN ISOLATION LEVEL READ COMMITTED;

END]]></Value>
			</Property>
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="BodyDependencies">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[TransactionRateSec].[@EndDate]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[TransactionRateSec].[@MinutesBack]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[varchar]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[RAMmb]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[Server].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[TransactionRateSec].[@ServerName]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TimeKey]" />
				</Entry>
				<Entry>
					<References ExternalSource="BuiltIns" Name="[int]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[TransactionRateSec]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[ServerNm]" />
				</Entry>
				<Entry>
					<References Name="[Analysis].[DiskMemoryStats].[DateKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="Parameters">
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[TransactionRateSec].[@ServerName]">
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[nvarchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[TransactionRateSec].[@EndDate]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[NULL]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSubroutineParameter" Name="[Analysis].[TransactionRateSec].[@MinutesBack]">
						<Property Name="DefaultExpressionScript">
							<Value><![CDATA[60]]></Value>
						</Property>
						<Relationship Name="Type">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References Name="[Analysis]" />
				</Entry>
			</Relationship>
			<Annotation Type="SysCommentsObjectAnnotation">
				<Property Name="CreateOffset" Value="150" />
				<Property Name="Length" Value="1419" />
				<Property Name="StartLine" Value="1" />
				<Property Name="StartColumn" Value="1" />
				<Property Name="HeaderContents" Value="-- =============================================&#xD;&#xA;-- Modified by: David Speight&#xD;&#xA;-- LoveTheSql.com&#xD;&#xA;-- =============================================&#xD;&#xA;CREATE PROCEDURE [Analysis].[TransactionRateSec] &#xD;&#xA;@ServerName NVARCHAR(50),&#xD;&#xA;@EndDate DATETIME = NULL,&#xD;&#xA;@MinutesBack INT = 60&#xD;&#xA;AS" />
			</Annotation>
		</Element>
		<Element Type="SqlCertificate" Name="[cert_keyAnalysis]">
			<Property Name="NewKeySubject" Value="Key Protection" />
			<Property Name="NewKeyStartDate" Value="2017-02-15T15:25:46" />
			<Property Name="NewKeyExpireDate" Value="2018-02-15T15:25:46" />
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="GloballyScoped" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF__DimAudit__ExecSt__1FCDBCEB]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[(getdate())]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[DimAudit].[ExecStartDT]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="16" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF__DimAudit__PkgNam__1ED998B2]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[('Unknown')]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[DimAudit].[PkgName]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="17" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF__DimAudit__Succes__20C1E124]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[('N')]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[DimAudit].[SuccessfulProcessingInd]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="18" />
		</Element>
		<Element Type="SqlDefaultConstraint" Name="[dbo].[DF__DimAudit__TableN__1DE57479]">
			<Property Name="DefaultExpressionScript">
				<Value><![CDATA[('Unknown')]]></Value>
			</Property>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForColumn">
				<Entry>
					<References Name="[dbo].[DimAudit].[TableName]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="19" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[DimAudit]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[AuditKey]">
						<Property Name="IsNullable" Value="False" />
						<Property Name="IsIdentity" Value="True" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[ParentAuditKey]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[TableName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="19" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[PkgName]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="17" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[PkgGUID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[PkgVersionGUID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[PkgVersionMajor]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[PkgVersionMinor]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[smallint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[ExecStartDT]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="16" />
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[ExecStopDT]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[ExecutionInstanceGUID]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[uniqueidentifier]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[ExtractRowCnt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[InsertRowCnt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[UpdateRowCnt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[ErrorRowCnt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[TableInitialRowCnt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[TableFinalRowCnt]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bigint]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[TableMaxDateTime]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimAudit].[SuccessfulProcessingInd]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
						<AttachedAnnotation Disambiguator="18" />
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="20" />
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="21" />
		</Element>
		<Element Type="SqlTable" Name="[dbo].[DimDate]">
			<Property Name="IsAnsiNullsOn" Value="True" />
			<Relationship Name="Columns">
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DateKey]">
						<Property Name="IsNullable" Value="False" />
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[int]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[Date]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[datetime]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[FullDateUK]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[FullDateUSA]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfMonth]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DaySuffix]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="9" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfWeekUSA]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfWeekUK]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfWeekInMonth]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfWeekInYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfQuarter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="3" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[DayOfYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="3" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[WeekOfMonth]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[WeekOfQuarter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[WeekOfYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[Month]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[MonthName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="9" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[MonthOfQuarter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="2" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[Quarter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="1" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[QuarterName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="9" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[Year]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="4" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[YearName]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="7" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[MonthYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="10" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[MMYYYY]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="6" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[char]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[FirstDayOfMonth]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[LastDayOfMonth]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[FirstDayOfQuarter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[LastDayOfQuarter]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[FirstDayOfYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[LastDayOfYear]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[date]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[IsHolidayUSA]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[IsWeekday]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[HolidayUSA]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[IsHolidayUK]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[bit]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
				<Entry>
					<Element Type="SqlSimpleColumn" Name="[dbo].[DimDate].[HolidayUK]">
						<Relationship Name="TypeSpecifier">
							<Entry>
								<Element Type="SqlTypeSpecifier">
									<Property Name="Length" Value="50" />
									<Relationship Name="Type">
										<Entry>
											<References ExternalSource="BuiltIns" Name="[varchar]" />
										</Entry>
									</Relationship>
								</Element>
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="Schema">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Annotation Type="SqlInlineConstraintAnnotation" Disambiguator="22" />
		</Element>
		<Element Type="SqlForeignKeyConstraint" Name="[dbo].[FK_dbo_DimAudit_ParentAuditKey]">
			<Relationship Name="Columns">
				<Entry>
					<References Name="[dbo].[DimAudit].[ParentAuditKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignColumns">
				<Entry>
					<References Name="[dbo].[DimAudit].[AuditKey]" />
				</Entry>
			</Relationship>
			<Relationship Name="ForeignTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="21" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK__DimDate__40DF45E3F5C62064]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[DimDate].[DateKey]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimDate]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="22" />
		</Element>
		<Element Type="SqlPrimaryKeyConstraint" Name="[dbo].[PK_dbo.DimAudit]">
			<Relationship Name="ColumnSpecifications">
				<Entry>
					<Element Type="SqlIndexedColumnSpecification">
						<Relationship Name="Column">
							<Entry>
								<References Name="[dbo].[DimAudit].[AuditKey]" />
							</Entry>
						</Relationship>
					</Element>
				</Entry>
			</Relationship>
			<Relationship Name="DefiningTable">
				<Entry>
					<References Name="[dbo].[DimAudit]" />
				</Entry>
			</Relationship>
			<AttachedAnnotation Disambiguator="20" />
		</Element>
		<Element Type="SqlSymmetricKey" Name="[key_Analysis]">
			<Property Name="Algorithm" Value="8" />
			<Relationship Name="Authorizer">
				<Entry>
					<References ExternalSource="BuiltIns" Name="[dbo]" />
				</Entry>
			</Relationship>
			<Relationship Name="EncryptionCertificates">
				<Entry>
					<References Name="[cert_keyAnalysis]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlLogin" Name="[PSuser]">
			<Property Name="Password" Value="LoveTheSql!" />
			<Annotation Type="GloballyScoped" />
		</Element>
		<Element Type="SqlUser" Name="[PSuser]" Disambiguator="3">
			<Property Name="LoginIdentifierScript">
				<Value><![CDATA[[PSuser]]]></Value>
			</Property>
			<Property Name="AuthenticationType" Value="1" />
			<Relationship Name="Login">
				<Entry>
					<References Name="[PSuser]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlLogin" Name="[SSISuser]">
			<Property Name="Password" Value="LoveTheSql!" />
			<Annotation Type="GloballyScoped" />
		</Element>
		<Element Type="SqlUser" Name="[SSISuser]" Disambiguator="5">
			<Property Name="LoginIdentifierScript">
				<Value><![CDATA[[SSISuser]]]></Value>
			</Property>
			<Property Name="AuthenticationType" Value="1" />
			<Relationship Name="Login">
				<Entry>
					<References Name="[SSISuser]" />
				</Entry>
			</Relationship>
		</Element>
		<Element Type="SqlLogin" Name="[SSRSuser]">
			<Property Name="Password" Value="LoveTheSql!" />
			<Annotation Type="GloballyScoped" />
		</Element>
		<Element Type="SqlUser" Name="[SSRSuser]" Disambiguator="4">
			<Property Name="LoginIdentifierScript">
				<Value><![CDATA[[SSRSuser]]]></Value>
			</Property>
			<Property Name="AuthenticationType" Value="1" />
			<Relationship Name="Login">
				<Entry>
					<References Name="[SSRSuser]" />
				</Entry>
			</Relationship>
		</Element>
	</Model>
</DataSchemaModel>